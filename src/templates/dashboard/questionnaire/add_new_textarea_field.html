{% extends 'dashboard/dashboard_base.html' %} {% load static %}
<!--Title-->
{% block title %}Dashboard - Start create{% endblock title %}
<!--Main content-->
<!-- Styles -->
{% block styles %}
<link
  rel="stylesheet"
  href="{% static 'css/dashboard/questionnaires/questionnaires.css' %}"
/>
{% endblock styles %}
<!-- Styles -->
<!--Header-->
{% block back %}
<div class="back-button">
  <a href="{% url 'questionnaire_detail' block_template.id %}">
    <img src="{% static 'images/icons/arrow-left.svg' %}" alt="Back button" />
  </a>
</div>
{% endblock back %}
<!---->
{% block title_page %}Текстове поле{%endblock title_page %}
<!--Header-->

<!--Content-->
{% block main %} {% load static %}
<form id="field-form" action="#" method="POST">
  {% csrf_token %}
  <div class="add_new_field marg_bottom-20 d-flex">
    <button type="submit" class="button_primary button_reset btn-icon offset-right-10" id="submit-button">
      <svg class="offset-right-5" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7 14C6.71667 14 6.47933 13.904 6.288 13.712C6.096 13.5207 6 13.2833 6 13V8H1C0.716667 8 0.479 7.904 0.287 7.712C0.0956668 7.52067 0 7.28333 0 7C0 6.71667 0.0956668 6.479 0.287 6.287C0.479 6.09567 0.716667 6 1 6H6V1C6 0.716667 6.096 0.479 6.288 0.287C6.47933 0.0956668 6.71667 0 7 0C7.28333 0 7.521 0.0956668 7.713 0.287C7.90433 0.479 8 0.716667 8 1V6H13C13.2833 6 13.5207 6.09567 13.712 6.287C13.904 6.479 14 6.71667 14 7C14 7.28333 13.904 7.52067 13.712 7.712C13.5207 7.904 13.2833 8 13 8H8V13C8 13.2833 7.90433 13.5207 7.713 13.712C7.521 13.904 7.28333 14 7 14Z" fill="currentColor"/>
      </svg>
      <p>Додати</p>
    </button>
    <a href="{% url 'fetch_library_templates' block_template.id %}" class="button_primary_outline button_reset btn-icon">
      <p>Вибрати із шаблонів</p>
      <p>
        <svg width="7" height="12" viewBox="0 0 7 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.70249 11.3C0.519157 11.1167 0.42749 10.8833 0.42749 10.6C0.42749 10.3167 0.519157 10.0833 0.70249 9.9L4.60249 6L0.70249 2.1C0.519157 1.91667 0.42749 1.68333 0.42749 1.4C0.42749 1.11667 0.519157 0.883332 0.70249 0.699999C0.885823 0.516666 1.11916 0.424999 1.40249 0.424999C1.68582 0.424999 1.91916 0.516666 2.10249 0.699999L6.70249 5.3C6.80249 5.4 6.87349 5.50833 6.91549 5.625C6.95682 5.74167 6.97749 5.86667 6.97749 6C6.97749 6.13333 6.95682 6.25833 6.91549 6.375C6.87349 6.49167 6.80249 6.6 6.70249 6.7L2.10249 11.3C1.91916 11.4833 1.68582 11.575 1.40249 11.575C1.11916 11.575 0.885823 11.4833 0.70249 11.3Z" fill="currentColor"/>
        </svg>          
      </p>
    </a>
  </div>
  <div class="d-flex">
    <div class="border-field">
      <div class="input-panel">
        <div class="group-form">
          <label for="id_name" class="input_label">
            <input
              type="text"
              class="input-title"
              autofocus
              placeholder="Уведіть заголовок"
              id="id_name"
              required
              name="name"
              maxlength="128"
            />
          </label>
          <span>
            <img src="{% static 'images/icons/required.svg' %}" alt="" />
          </span>
        </div>
        <textarea
          type="text"
          id="template-text"
          name="template-text"
          class="input_base"
          placeholder="Přidejte popis"
          minlength="3"
          maxlength="250"
        ></textarea>
        <p>
          <label for="help_info"></label>
          <input
            type="text"
            id="help_info"
            name="help_info"
            class="input-title"
            placeholder="Текст підказка"
          />
        </p>
      </div>
    </div>
    <div class="settings-panel">
      <div class="checkbox-container justify-content-start marg_bottom-10">
        <label class="checkbox">
          <input
            id="required-fill"
            type="checkbox"
            id="is_required"
            name="is_required"
            value="true"
          />
          <div class="circle"></div>
          <div class="box">
            <span class="checkmark"></span>
          </div>
        </label>
        <span>Обов’язкове до заповнення</span>
      </div>
      <div class="checkbox-container justify-content-start marg_bottom-10">
        <label class="checkbox">
          <input type="checkbox" id="required-fill-help-text" />
          <div class="circle"></div>
          <div class="box">
            <span class="checkmark"></span>
          </div>
        </label>
        <span>Допоміжний текст (Текст підказка)</span>
      </div>
      <!-- Title -->
      <div class="settings-panel-title">Тип введення</div>
      <!-- Title -->
      <div class="radio-container marg_bottom-10">
        <div class="radio-container">
          <input
            type="radio"
            id="type-text"
            type="radio"
            id="type-text"
            name="field_type"
            value="textarea"
          />
          <label for="type-text">Довільне</label>
        </div>
      </div>
      <div class="block-muted">
        <!-- Title -->
        <div class="settings-panel-title">Кількість символів:</div>
        <!-- Title -->
        <div class="radio-container marg_bottom-10">
          <div class="radio-container">
            <input type="radio" id="max-60" name="max_symbols" value="60" />
            <label for="max-60">до 60</label>
          </div>
        </div>
        <div class="radio-container marg_bottom-10">
          <div class="radio-container">
            <input type="radio" id="max-250" name="max_symbols" value="250" />
            <label for="max-250">до 250 <span>(рекомендовано)</span></label>
          </div>
        </div>
        <div class="radio-container marg_bottom-10">
          <div class="radio-container">
            <input type="radio" id="max-500" name="max_symbols" value="500" />
            <label for="max-500">до 500</label>
          </div>
        </div>
        <div class="radio-container marg_bottom-10">
          <div class="radio-container">
            <input type="radio" id="max-1000" name="max_symbols" value="1000" />
            <label for="max-500">до 1000</label>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
<div class="add-new-lang-block">
  <a
    href="{% url 'de_language_textarea_field' block_template.id %}"
    class="button_primary_outline button_reset"
    id="copy-button"
  >
    Зберегти і додати іншомовний варіант
    <!-- <p>
    <img src="{% static 'images/icons/plus-blue.svg' %}" alt="Add button" />
  </p> -->
  </a>
</div>
{% endblock main %} {% block scripts %}
<script src="{% static 'js/questionnaire/text-area.js' %}"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const copyButton = document.getElementById("copy-button");
    const submitButton = document.getElementById("submit-button");
    const form = document.getElementById("field-form");

    function handleFormSubmission(event, redirectUrl) {
      event.preventDefault(); // Запобігаємо стандартній поведінці форми

      const formData = new FormData(form);

      // Виконуємо запит на сервер
      fetch("{% url 'create_field' block_template.id %}", {
        method: "POST",
        body: formData,
      })
        .then((response) => response.json())
        .then((data) => {
          if (data.status === "success") {
            alert(data.message);

            // Перехід за посиланням після успішної відправки
            window.location.href = redirectUrl;
          } else {
            alert("Помилка: " + data.message);
          }
        })
        .catch((error) => console.error("Помилка:", error));
    }

    // Додаємо обробник для кнопки submit
    submitButton.addEventListener("click", function (e) {
      handleFormSubmission(
        e,
        "{% url 'questionnaire_detail' block_template.id %}"
      );
    });

    // Додаємо обробник для посилання
    copyButton.addEventListener("click", function (e) {
      handleFormSubmission(e, copyButton.href);
    });
  });
</script>
{% endblock scripts %}
